<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Manage Appointments</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css">
    <!-- or -->
    <link rel="stylesheet"
          href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <style>
        a {
            text-decoration: none;
        }
    </style>
</head>
<body>

<div th:replace="fragments/header :: header"></div>

<div class="container mt-5">
    <h1 th:text="${appointment.appointmentId == null ? 'Add New Appointment' : 'Edit Appointment'}"></h1>

    <form th:action="@{/appointments}" th:object="${appointment}" method="post" class="mb-3">
        <input type="hidden" th:field="*{appointmentId}">

        <div class="mb-3">
            <label for="patient" class="form-label">Patient</label>
            <select class="form-select" id="patient" th:field="*{patient.patientId}">
                <option th:each="patient : ${patients}" th:value="${patient.patientId}" th:text="${patient.fullName}"></option>
            </select>
        </div>

        <div class="mb-3">
            <label for="doctor" class="form-label">Doctor</label>
            <select class="form-select" id="doctor" th:field="*{doctor.doctorId}">
                <option th:each="doctor : ${doctors}" th:value="${doctor.doctorId}" th:text="${doctor.fullName}"></option>
            </select>
        </div>

        <div class="mb-3">
            <label for="appointmentDate" class="form-label">Appointment Date</label>
            <input type="datetime-local" class="form-control" id="appointmentDate" th:field="*{appointmentDate}" required>
        </div>

        <div class="mb-3">
            <label for="reason" class="form-label">Reason</label>
            <input type="text" class="form-control" id="reason" th:field="*{reason}" placeholder="Enter reason">
        </div>

        <div class="mb-3">
            <label for="status" class="form-label">Status</label>
            <select class="form-select" id="status" th:field="*{status}">
                <option value="pending">Pending</option>
                <option value="confirmed">Confirmed</option>
                <option value="completed">Completed</option>
                <option value="cancelled">Cancelled</option>
            </select>
        </div>

        <button type="submit" class="btn btn-primary" th:text="${appointment.appointmentId == null ? 'Save' : 'Update'}"></button>
    </form>

    <a href="/appointments" class="btn btn-secondary">Back</a>

    <hr/>
    <h2>Appointments List</h2>
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>ID</th>
            <th>Patient</th>
            <th>Doctor</th>
            <th>Date</th>
            <th>Reason</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="appointment : ${appointments}">
            <td th:text="${appointment.appointmentId}"></td>
            <td th:text="${appointment.patient.fullName}"></td>
            <td th:text="${appointment.doctor.fullName}"></td>
<!--            <td th:text="${appointment.appointmentDate}"></td>-->
            <td th:text="${#dates.format(appointment.appointmentDate, 'dd/MM/yyyy')}"></td>
            <td th:text="${appointment.reason}"></td>
            <td th:text="${appointment.status}"></td>
            <td>
                <a th:href="@{/appointments/edit/{id}(id=${appointment.appointmentId})}" class="btn btn-warning">Edit</a>
                <a th:href="@{/appointments/delete/{id}(id=${appointment.appointmentId})}" class="btn btn-danger">Delete</a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div th:replace="fragments/footer :: footer"></div>

</body>

<script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>

</html>
